<p align="center">
  <img src="time_series_forecasting.png" alt="Time Series Forecasting Screenshot" width="400"/>
</p>

<h1 align="center"> üå°Ô∏è Time Series Forecasting with Amazon Chronos üå°Ô∏è</h1>

<p align="center">
  <strong>A comprehensive Python application for time series forecasting using Amazon Chronos and a multi-site air quality dataset.</strong>
</p>

<p align="center">
  <a href="https://github.com/yourusername/yourrepository">
    <img src="https://img.shields.io/github/license/its-amann/Amazon-Chrones-Model.svg" alt="License">
  </a>
  <a href="https://github.com/yourusername/yourrepository/issues">
    <img src="https://img.shields.io/github/issues/its-amann/Amazon-Chrones-Model.svg" alt="Issues">
  </a>
  <a href="https://github.com/yourusername/yourrepository/stargazers">
    <img src="https://img.shields.io/github/stars/its-amann/Amazon-Chrones-Model.svg" alt="Stars">
  </a>
</p>

---

## üöÄ Overview

Welcome to the **Time Series Forecasting project**, a robust and analytical tool designed for predicting future values in time-dependent data. This project utilizes the **Amazon Chronos** library, a powerful time series forecasting framework, along with a multi-site air quality dataset from Beijing. It's ideal for anyone looking to understand, analyze, and predict time series data efficiently.

‚ú® **Key Highlights:**

-   **Advanced Forecasting:** Leverages Amazon Chronos for accurate time series predictions.
-   **Comprehensive Data Analysis:** Includes exploratory data analysis to understand the data patterns.
-   **Cross-Validation:** Implements cross-validation techniques for robust model evaluation.
-   **Parameter Tuning:** Features a parameter tuning module to optimize model performance.
-   **Visualization:** Generates clear visualizations for both data exploration and forecast evaluation.

<p align="center">
  <img src="time_series_architecture.png" alt="System Architecture" width="400"/>
</p>

---

## üõ† Features

-   **Data Loading & Cleaning:** Imports and processes a multi-site air quality dataset.
-   **Exploratory Data Analysis (EDA):** Visualizes data patterns, including hourly, monthly, and quarterly seasonality.
-   **Amazon Chronos Integration:** Utilizes pre-trained Amazon Chronos models for forecasting.
-   **Cross-Validation:** Evaluates model robustness using time series cross-validation.
-   **Hyperparameter Tuning:** Optimizes model performance through parameter grid search.
-   **Future Prediction:** Forecasts future time steps using the best-tuned model.
-   **Visualizations:** Plots actual data alongside predictions for easy comparison.
-   **Error Metrics:** Calculates and displays RMSE to assess prediction accuracy.

---

## üì∏ Screenshots
<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/33a56017-3cbd-4394-9da7-dd1504ef86dd)
" alt="Hourly Temperature Plot" width="400"/>
</p>
<p align="center">
  <font size="6">
    Hourly temperature data plot.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/cd6a8ed6-a6d6-430b-bb1c-8c83c4bf4039)
" alt="Monthly Temperature Plot" width="400"/>
</p>
<p align="center">
  <font size="6">
    Monthly seasonality of temperature, red lines represent monthly means.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/e5f4e7c0-a8bf-4d59-8cce-654e0e09f85e)
" alt="Quarterly Temperature Plot" width="400"/>
</p>
<p align="center">
  <font size="6">
    Quarterly seasonality of temperature data.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/0d3dd758-dd90-4aad-a0f1-672065caca41)
" alt="Prediction vs Actuals Plot 1" width="400"/>
</p>
<p align="center">
  <font size="6">
  First cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/baa78a45-e998-4cbd-b198-4b09e78b9bfa)
" alt="Prediction vs Actuals Plot 2" width="400"/>
</p>
<p align="center">
  <font size="6">
  Second cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="" alt="Prediction vs Actuals Plot 3" width="400"/>
</p>
<p align="center">
  <font size="6">
  Third cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/30af0853-a1d8-4936-8abf-6ac0b92adeb5)
" alt="Prediction vs Actuals Plot 4" width="400"/>
</p>
<p align="center">
  <font size="6">
  Fourth cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/d511aa25-d6bc-4f10-add1-e2c9c0b0857a)
" alt="Prediction vs Actuals Plot 5" width="400"/>
</p>
<p align="center">
  <font size="6">
  Fifth cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/54cf2c6c-ae16-4d7b-a847-cc22517410c0)
" alt="Prediction vs Actuals Plot 6" width="400"/>
</p>
<p align="center">
  <font size="6">
    Sixth cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="prediction_vs_actual_7.png" alt="Prediction vs Actuals Plot 7" width="400"/>
</p>
<p align="center">
  <font size="6">
  Seventh cross-validation, Actual vs. Predicted values.
  </font>
</p>


<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/65902550-b87f-4396-bece-030dbe6043f4)
" alt="Prediction vs Actuals Plot 10" width="400"/>
</p>
<p align="center">
  <font size="6">
  Tenth cross-validation, Actual vs. Predicted values.
  </font>
</p>

<p align="center">
  <img src="![image](https://github.com/user-attachments/assets/40098ee2-3ae0-4cb2-94bf-9876198a994c)
" alt="Tuned Forecast Plot" width="400"/>
</p>
<p align="center">
    <font size="6">
   Final forecast plot with tuned model parameters, Actual vs. Predicted values.
  </font>
</p>
---

## üîß Installation

### Prerequisites

-   **Python 3.x** installed on your machine. [Download Python](https://www.python.org/downloads/)
-   **pip** package installer.
-   **git** for cloning the repository

### Steps

1.  **Clone the Repository:**
    ```bash
    git clone https://github.com/yourusername/yourrepository.git
    cd your-repository
    ```

2.  **Install Dependencies:**
    ```bash
    pip install -q git+https://github.com/amazon-science/chronos-forecasting.git
    pip install -q tsdb
    pip install pandas
    pip install matplotlib
    pip install statsmodels
    pip install scikit-learn
    pip install numpy
    pip install torch
    ```

3.  **Run the Application:**
    ```bash
    python your_script_name.py
    ```

---

## üíª Usage

The script will automatically execute the following steps:

1.  **Data Import:** Loads the multi-site air quality dataset from the `tsdb` library.
2.  **Data Preprocessing:** Cleans and prepares the data for analysis, including creating a datetime index.
3.  **Exploratory Data Analysis:** Generates plots to visualize hourly, monthly, and quarterly temperature data patterns.
4.  **Model Initialization:** Initializes the Amazon Chronos forecasting model.
5.  **Initial Forecast:** Generates an initial forecast using default parameters.
6.  **Cross-Validation:** Evaluates the model performance using time series cross-validation, printing RMSE values for each fold.
7.  **Cross-Validation Visualization:** Plots cross-validation forecasts against actual values for all validation folds.
8.  **Parameter Tuning:** Conducts a grid search to identify the optimal model parameters.
9.   **Best Model:** Exports the best hyper parameters for future use.
10. **Final Forecast:**  Generates a forecast with the best parameters and visualizes the final forecast against the actuals.

### Code Details
-  **Libraries** 
     - `pandas` : For data manipulation and analysis.
    - `matplotlib` :  For data visualization.
    - `statsmodels` : For time series analysis plots like month_plot and quarter_plot.
    - `sklearn` : For model evaluation metrics such as mean_absolute_error, mean_squared_error, etc.
    - `numpy` :  For numerical operations.
    - `tsdb` : To load the dataset.
    - `chronos` : Amazon Chronos for time series forecasting.
     -`datetime` : For creating date time variables.
     -`torch` :  Deep learning library used for Chronos model.

-  **Data Loading and Preprocessing** 
    -  The script loads air quality data from multiple sites in Beijing, using the `tsdb` library.
    -  It converts date and time columns into a datetime format and set it as the index of the dataframe.
    -  The script focuses specifically on the `TEMP` column (renamed to `y`) from the 'Wanliu' station for analysis.

-  **Exploratory Data Analysis (EDA)**
     -  The script visualizes the time series data at hourly, monthly, and quarterly intervals to reveal trends and patterns.

-  **Amazon Chronos Model**
    - A ChronosPipeline model is instantiated using a pre-trained model from "amazon/chronos-t5-base".
    - It demonstrates how to get predictions for the time series data.

-  **Cross-Validation**
    -  The script implements time series cross-validation to evaluate the model's predictive capability by splitting the data into several train/test folds and evaluates the RMSE in each fold.

-  **Parameter Tuning**
   - The script defines a grid of hyperparameters (temperature, top_k, top_p, num_samples) to tune the Chronos model using ParameterGrid from Scikit-learn.
   - It performs cross-validation for each combination of parameters to find the optimal configuration based on the RMSE.

-  **Final Prediction**
     -  Using the best parameters from the tuning process, the script performs a final forecast on the entire time series.

-   **Visualizations:**
    - Actual vs. predicted values plots, for both cross validation folds and the final forecast are plotted using the `matplotlib` library.
---

## ü§ù Contributing

1.  **Fork the Project**
2.  **Create your Feature Branch:** `git checkout -b feature/AmazingFeature`
3.  **Commit your Changes:** `git commit -m 'Add some AmazingFeature'`
4.  **Push to the Branch:** `git push origin feature/AmazingFeature`
5.  **Open a Pull Request**

---

## üìÑ License

Distributed under the MIT License. See `LICENSE` for more information.

---

## üôè Acknowledgments

-   This project leverages the powerful **Amazon Chronos** library for time series forecasting.
-   The multi-site air quality dataset from Beijing is provided by the **TSDB** library.
-   Inspired by the need for robust and efficient time series analysis solutions.

<p align="center">
  Made with ‚ù§Ô∏è by Aman
</p>
content_copy
download
Use code with caution.
Markdown
